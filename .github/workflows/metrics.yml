name: Metrics
on:
  # Schedule updates
  schedule: [{ cron: "0 */6 * * *" }]
  # Lines below let you run workflow manually and on each commit (optional)
  workflow_dispatch:
  push: { branches: ["main"] }

jobs:
  # blog:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - uses: lowlighter/metrics@latest
  #       with:
  #         filename: blog.svg
  #         token: NOT_NEEDED
  #         committer_token: ${{ secrets.GITHUB_TOKEN }}
  #         user: rselbach
  #         base: ''
  #         plugin_rss: yes
  #         plugin_rss_limit: 4
  #         template: classic
  #         plugin_rss_source: https://rselbach.com/index.xml

  header:
    runs-on: ubuntu-latest
    steps:
      - uses: lowlighter/metrics@latest
        with:
          filename: header.svg
          # You'll need to setup a personal token in your secrets.
          token: ${{ secrets.METRICS_SECRET }}
          # GITHUB_TOKEN is a special auto-generated token used for commits
          committer_token: ${{ secrets.GITHUB_TOKEN }}

          # Options
          user: rselbach
          template: classic
          base: header
          config_timezone: ${{ secrets.USER_TIMEZONE }}
  # lines:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - uses: lowlighter/metrics@latest
  #       with:
  #         filename: lines-of-code.svg
  #         token: ${{ secrets.METRICS_SECRET }}
  #         committer_token: ${{ secrets.GITHUB_TOKEN }}
  #         base: ""
  #         plugin_lines: yes
  #         plugin_lines_sections: repositories, history
  #         plugin_lines_repositories_limit: 2
  #         plugin_lines_history_limit: 1

  activities:
    runs-on: ubuntu-latest
    steps:
      - uses: lowlighter/metrics@latest
        with:
          filename: activities.svg
          # You'll need to setup a personal token in your secrets.
          token: ${{ secrets.METRICS_SECRET }}
          # GITHUB_TOKEN is a special auto-generated token used for commits
          committer_token: ${{ secrets.GITHUB_TOKEN }}

          # Options
          user: rselbach
          template: classic
          base: activity, community
          config_timezone: ${{ secrets.USER_TIMEZONE }}

  calendar:
    runs-on: ubuntu-latest
    steps:
      - uses: lowlighter/metrics@latest
        with:
          filename: calendar.svg
          # You'll need to setup a personal token in your secrets.
          token: ${{ secrets.METRICS_SECRET }}
          # GITHUB_TOKEN is a special auto-generated token used for commits
          committer_token: ${{ secrets.GITHUB_TOKEN }}

          # Options
          user: rselbach
          template: classic
          base: ""
          config_timezone: ${{ secrets.USER_TIMEZONE }}
          plugin_isocalendar: yes
          plugin_isocalendar_duration: half-year

  # habits:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - uses: lowlighter/metrics@latest
  #       with:
  #         filename: github-habits.svg
  #         token: ${{ secrets.METRICS_SECRET }}
  #         committer_token: ${{ secrets.GITHUB_TOKEN }}
  #         config_timezone: ${{ secrets.USER_TIMEZONE }} # Set timezone
  #         user: rselbach
  #         base: ""
  #         template: classic
  #         plugin_habits: yes
  #         plugin_habits_from: 20       # Use 200 events to compute habits
  #         plugin_habits_days: 14        # Keep only events from last 14 days
  #         plugin_habits_charts: yes     # Display charts section
  #         plugin_habits_trim: yes       # Trim unused hours on daily chart

  repositories:
    runs-on: ubuntu-latest
    steps:
      - uses: lowlighter/metrics@latest
        with:
          filename: repositories.svg
          # You'll need to setup a personal token in your secrets.
          token: ${{ secrets.METRICS_SECRET }}
          # GITHUB_TOKEN is a special auto-generated token used for commits
          committer_token: ${{ secrets.GITHUB_TOKEN }}

          # Options
          user: rselbach
          template: classic
          base: repositories
          config_timezone: ${{ secrets.USER_TIMEZONE }}

  # languages:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - uses: lowlighter/metrics@latest
  #       with:
  #         filename: languages.svg
  #         token: ${{ secrets.METRICS_SECRET }}
  #         plugin_languages: yes
  #         plugin_languages_limit: 8
  #         plugin_languages_details: bytes-size, percentage

  #         # Options
  #         user: rselbach
  #         template: classic
  #         base: ''
  #         config_timezone: ${{ secrets.USER_TIMEZONE }}
